<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store Details | Admin Panel</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                            800: '#166534',
                            900: '#14532d',
                            950: '#052e16',
                        }
                    }
                }
            }
        }
    </script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50">
    <div class="min-h-screen flex flex-col">
        <!-- Top Navigation -->
        <nav class="bg-white shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex">
                        <a href="/admin/dashboard" class="flex-shrink-0 flex items-center">
                            <img class="h-8 w-auto" src="/images/logo.png" alt="Agrifin">
                            <span class="ml-2 text-xl font-bold text-gray-900">Admin Panel</span>
                        </a>
                        <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                            <a href="/admin/dashboard" class="border-primary-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                                Dashboard
                            </a>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="ml-3 relative">
                            <div>
                                <button type="button" class="bg-white rounded-full flex text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500" id="user-menu-button">
                                    <span class="sr-only">Open user menu</span>
                                    <img class="h-8 w-8 rounded-full" src="/images/admin-placeholder.svg" alt="">
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="flex-1">
            <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
                <!-- Breadcrumbs -->
                <nav class="flex mb-5" aria-label="Breadcrumb">
                    <ol class="inline-flex items-center space-x-1 md:space-x-3">
                        <li class="inline-flex items-center">
                            <a href="/admin/dashboard" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-primary-600">
                                <i class="fas fa-home mr-2"></i>
                                Dashboard
                            </a>
                        </li>
                        <li>
                            <div class="flex items-center">
                                <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
                                <a href="/admin/dashboard#sellers" class="text-sm font-medium text-gray-700 hover:text-primary-600">Sellers</a>
                            </div>
                        </li>
                        <li aria-current="page">
                            <div class="flex items-center">
                                <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
                                <span class="text-sm font-medium text-gray-500" id="store-name-breadcrumb">Store Details</span>
                            </div>
                        </li>
                    </ol>
                </nav>

                <!-- Back Button -->
                <div class="mb-5">
                    <a href="/admin/dashboard#sellers" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-gray-700 bg-gray-100 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                        <i class="fas fa-arrow-left mr-2"></i>
                        Back to Sellers
                    </a>
                </div>

                <!-- Store Details -->
                <div class="bg-white shadow overflow-hidden sm:rounded-lg mb-6">
                    <div class="px-4 py-5 sm:px-6 flex justify-between items-center">
                        <div>
                            <h3 class="text-lg leading-6 font-medium text-gray-900" id="store-name-header">Store Details</h3>
                            <p class="mt-1 max-w-2xl text-sm text-gray-500">Detailed information about the store and seller.</p>
                        </div>
                        <div class="flex space-x-2">
                            <button id="edit-store-btn" class="inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                <i class="fas fa-edit mr-2"></i>
                                Edit
                            </button>
                            <button id="toggle-status-btn" class="inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-amber-700 bg-amber-100 hover:bg-amber-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500">
                                <i class="fas fa-ban mr-2"></i>
                                <span id="toggle-status-text">Block</span>
                            </button>
                        </div>
                    </div>
                    <div class="border-t border-gray-200">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-6">
                            <!-- Store Info -->
                            <div class="col-span-1 bg-white shadow rounded-lg overflow-hidden">
                                <div class="p-6">
                                    <div class="flex items-center mb-4">
                                        <div class="flex-shrink-0 h-16 w-16 rounded-full overflow-hidden bg-gray-100">
                                            <img id="store-logo" src="/images/store-placeholder.svg" alt="Store Logo" class="h-16 w-16 object-cover">
                                        </div>
                                        <div class="ml-4">
                                            <h2 id="store-name" class="text-xl font-bold text-gray-900">Store Name</h2>
                                            <div id="store-status" class="mt-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                Active
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mt-4 space-y-3">
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500">Description</h3>
                                            <p id="store-description" class="mt-1 text-sm text-gray-900">Store description will appear here.</p>
                                        </div>
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500">Location</h3>
                                            <p id="store-location" class="mt-1 text-sm text-gray-900">Store location</p>
                                        </div>
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500">Contact Info</h3>
                                            <p id="store-contact" class="mt-1 text-sm text-gray-900">Contact information</p>
                                        </div>
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500">Created At</h3>
                                            <p id="store-created-at" class="mt-1 text-sm text-gray-900">Creation date</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Seller Info -->
                            <div class="col-span-1 bg-white shadow rounded-lg overflow-hidden">
                                <div class="p-6">
                                    <h3 class="text-lg font-medium text-gray-900 mb-4">Seller Information</h3>
                                    <div class="flex items-center mb-4">
                                        <div class="flex-shrink-0 h-12 w-12 rounded-full overflow-hidden bg-gray-100">
                                            <img id="seller-avatar" src="/images/default-profile.svg" alt="Seller Avatar" class="h-12 w-12 object-cover">
                                        </div>
                                        <div class="ml-4">
                                            <h2 id="seller-name" class="text-lg font-medium text-gray-900">Seller Name</h2>
                                            <p id="seller-email" class="text-sm text-gray-500">seller@example.com</p>
                                        </div>
                                    </div>
                                    <div class="mt-4 space-y-3">
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500">User ID</h3>
                                            <p id="seller-id" class="mt-1 text-sm text-gray-900">User ID</p>
                                        </div>
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500">Phone</h3>
                                            <p id="seller-phone" class="mt-1 text-sm text-gray-900">Phone number</p>
                                        </div>
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500">Joined</h3>
                                            <p id="seller-joined" class="mt-1 text-sm text-gray-900">Join date</p>
                                        </div>
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500">Status</h3>
                                            <p id="seller-status" class="mt-1 text-sm text-gray-900">
                                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                    Active
                                                </span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Store Stats -->
                            <div class="col-span-1 bg-white shadow rounded-lg overflow-hidden">
                                <div class="p-6">
                                    <h3 class="text-lg font-medium text-gray-900 mb-4">Store Statistics</h3>
                                    <div class="space-y-4">
                                        <div class="bg-gray-50 p-4 rounded-lg">
                                            <div class="flex justify-between items-center">
                                                <h4 class="text-sm font-medium text-gray-500">Total Products</h4>
                                                <span id="total-products" class="text-lg font-semibold text-gray-900">0</span>
                                            </div>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded-lg">
                                            <div class="flex justify-between items-center">
                                                <h4 class="text-sm font-medium text-gray-500">Total Orders</h4>
                                                <span id="total-orders" class="text-lg font-semibold text-gray-900">0</span>
                                            </div>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded-lg">
                                            <div class="flex justify-between items-center">
                                                <h4 class="text-sm font-medium text-gray-500">Total Revenue</h4>
                                                <span id="total-revenue" class="text-lg font-semibold text-gray-900">$0.00</span>
                                            </div>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded-lg">
                                            <div class="flex justify-between items-center">
                                                <h4 class="text-sm font-medium text-gray-500">Average Rating</h4>
                                                <span id="average-rating" class="text-lg font-semibold text-gray-900">
                                                    <i class="fas fa-star text-yellow-400"></i>
                                                    <span>0.0</span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Store Products -->
                <div class="bg-white shadow overflow-hidden sm:rounded-lg mb-6">
                    <div class="px-4 py-5 sm:px-6">
                        <h3 class="text-lg leading-6 font-medium text-gray-900">Store Products</h3>
                        <p class="mt-1 max-w-2xl text-sm text-gray-500">Products offered by this store.</p>
                    </div>
                    <div class="border-t border-gray-200">
                        <div class="p-6">
                            <div id="products-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                                <!-- Products will be loaded here -->
                                <div class="text-center text-gray-500 py-8 col-span-full" id="no-products-message">
                                    <i class="fas fa-box-open text-4xl mb-2"></i>
                                    <p>No products found for this store.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-white">
            <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
                <p class="text-center text-sm text-gray-500">
                    &copy; 2023 Agrifin Palestine. All rights reserved.
                </p>
            </div>
        </footer>
    </div>

    <!-- JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get store ID from URL
            const urlParams = new URLSearchParams(window.location.search);
            const sellerId = urlParams.get('id');

            if (!sellerId) {
                showError('No seller ID provided');
                return;
            }

            // Fetch store details
            fetchStoreDetails(sellerId);

            // Set up event listeners
            document.getElementById('edit-store-btn').addEventListener('click', function() {
                // Check if this button has been repurposed for creating a store
                if (this.getAttribute('data-action') === 'create') {
                    // Redirect to create store page
                    window.location.href = `/admin/stores/create?userId=${sellerId}`;
                } else {
                    // Redirect to edit store page
                    window.location.href = `/admin/stores/edit?id=${this.getAttribute('data-store-id')}`;
                }
            });

            document.getElementById('toggle-status-btn').addEventListener('click', function() {
                const currentStatus = this.getAttribute('data-status');
                const newStatus = currentStatus === 'BANNED' ? 'ACTIVE' : 'BANNED';
                updateSellerStatus(sellerId, newStatus);
            });
        });

        function fetchStoreDetails(sellerId) {
            const token = localStorage.getItem('token');

            // Fetch seller details
            fetch(`/api/admin/users/${sellerId}`, {
                headers: {
                    'Authorization': token ? `Bearer ${token}` : '',
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to fetch seller details');
                }
                return response.json();
            })
            .then(seller => {
                // Update seller info
                updateSellerInfo(seller);

                // Check if seller has a store
                if (seller.hasStore === true && seller.storeId) {
                    // Seller has a store, fetch store details by store ID
                    return fetch(`/api/admin/stores/${seller.storeId}`, {
                        headers: {
                            'Authorization': token ? `Bearer ${token}` : '',
                            'Content-Type': 'application/json'
                        }
                    });
                } else {
                    // Seller doesn't have a store, create a placeholder store object
                    return {
                        ok: true,
                        json: () => ({
                            storeName: 'No Store',
                            storeDescription: 'This seller has not created a store yet.',
                            location: seller.region || 'N/A',
                            contactInfo: seller.phone || 'N/A',
                            createdAt: seller.createdAt,
                            status: seller.status || (seller.isActive ? 'ACTIVE' : 'INACTIVE'),
                            productCount: 0,
                            orderCount: 0,
                            totalRevenue: 0,
                            averageRating: 0,
                            isPlaceholder: true // Flag to indicate this is a placeholder
                        })
                    };
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to fetch store details');
                }
                return response.json();
            })
            .then(store => {
                // Update store info
                updateStoreInfo(store);

                // If this is a placeholder store (seller has no store), don't try to fetch products
                if (store.isPlaceholder) {
                    // Return empty products array
                    return [];
                }

                // Fetch store products
                return fetch(`/api/admin/stores/${store.storeId}/products`, {
                    headers: {
                        'Authorization': token ? `Bearer ${token}` : '',
                        'Content-Type': 'application/json'
                    }
                });
            })
            .then(response => {
                if (!response.ok) {
                    // If we can't fetch products, just show empty state
                    return [];
                }
                return response.json();
            })
            .then(products => {
                // Update products
                updateStoreProducts(products);
            })
            .catch(error => {
                console.error('Error:', error);
                showError(error.message);
            });
        }

        function updateSellerInfo(seller) {
            // Update seller details
            document.getElementById('seller-name').textContent = seller.fullName || `${seller.firstName || ''} ${seller.lastName || ''}`;
            document.getElementById('seller-email').textContent = seller.email || 'N/A';
            document.getElementById('seller-id').textContent = seller.userId || seller.id || 'N/A';
            document.getElementById('seller-phone').textContent = seller.phone || 'N/A';
            document.getElementById('seller-joined').textContent = formatDate(seller.createdAt) || 'N/A';

            // Update seller status
            const statusElement = document.getElementById('seller-status');
            const status = seller.status || (seller.isActive ? 'ACTIVE' : seller.isBanned ? 'BANNED' : 'INACTIVE');

            let statusClass = 'bg-gray-100 text-gray-800';
            if (status === 'ACTIVE') {
                statusClass = 'bg-green-100 text-green-800';
            } else if (status === 'BANNED') {
                statusClass = 'bg-red-100 text-red-800';
            } else if (status === 'INACTIVE') {
                statusClass = 'bg-yellow-100 text-yellow-800';
            }

            statusElement.innerHTML = `
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusClass}">
                    ${status}
                </span>
            `;

            // Update toggle status button
            const toggleBtn = document.getElementById('toggle-status-btn');
            const toggleText = document.getElementById('toggle-status-text');
            const toggleIcon = toggleBtn.querySelector('i');

            toggleBtn.setAttribute('data-status', status);

            if (status === 'BANNED') {
                toggleText.textContent = 'Unblock';
                toggleIcon.className = 'fas fa-unlock mr-2';
                toggleBtn.className = 'inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-green-700 bg-green-100 hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500';
            } else {
                toggleText.textContent = 'Block';
                toggleIcon.className = 'fas fa-ban mr-2';
                toggleBtn.className = 'inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-amber-700 bg-amber-100 hover:bg-amber-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500';
            }

            // Update seller avatar
            if (seller.profileImage) {
                document.getElementById('seller-avatar').src = seller.profileImage;
            }
        }

        function updateStoreInfo(store) {
            // Update store details
            document.getElementById('store-name').textContent = store.storeName || 'Unnamed Store';
            document.getElementById('store-name-header').textContent = store.storeName || 'Unnamed Store';
            document.getElementById('store-name-breadcrumb').textContent = store.storeName || 'Unnamed Store';
            document.getElementById('store-description').textContent = store.storeDescription || 'No description available.';
            document.getElementById('store-location').textContent = store.location || 'N/A';
            document.getElementById('store-contact').textContent = store.contactInfo || 'N/A';
            document.getElementById('store-created-at').textContent = formatDate(store.createdAt) || 'N/A';

            // Update store status
            const statusElement = document.getElementById('store-status');
            const status = store.status || (store.isActive ? 'ACTIVE' : 'INACTIVE');

            let statusClass = 'bg-gray-100 text-gray-800';
            if (status === 'ACTIVE') {
                statusClass = 'bg-green-100 text-green-800';
            } else if (status === 'INACTIVE') {
                statusClass = 'bg-yellow-100 text-yellow-800';
            }

            statusElement.className = `mt-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusClass}`;
            statusElement.textContent = status;

            // Update store logo
            if (store.storeLogo) {
                document.getElementById('store-logo').src = store.storeLogo;
            }

            // Update store stats
            document.getElementById('total-products').textContent = store.productCount || '0';
            document.getElementById('total-orders').textContent = store.orderCount || '0';
            document.getElementById('total-revenue').textContent = formatCurrency(store.totalRevenue || 0);
            document.getElementById('average-rating').innerHTML = `
                <i class="fas fa-star text-yellow-400"></i>
                <span>${store.averageRating?.toFixed(1) || '0.0'}</span>
            `;

            // If this is a placeholder store, show a message
            if (store.isPlaceholder) {
                // Add a notice at the top of the store info section
                const storeInfoSection = document.querySelector('.col-span-1:first-child .p-6');

                // Remove any existing notice
                const existingNotice = storeInfoSection.querySelector('.store-notice');
                if (existingNotice) {
                    existingNotice.remove();
                }

                const notice = document.createElement('div');
                notice.className = 'mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md store-notice';
                notice.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>
                        <p class="text-sm text-yellow-700">This seller doesn't have a store yet. The information shown is placeholder data.</p>
                    </div>
                `;
                storeInfoSection.insertBefore(notice, storeInfoSection.firstChild);

                // Change the edit button to a create button
                const editStoreBtn = document.getElementById('edit-store-btn');
                editStoreBtn.textContent = 'Create Store';
                editStoreBtn.setAttribute('data-action', 'create');
                editStoreBtn.className = 'inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500';
                editStoreBtn.title = 'Create a store for this seller';
            } else {
                // Make sure the edit button has the correct attributes for editing
                const editStoreBtn = document.getElementById('edit-store-btn');
                editStoreBtn.textContent = 'Edit Store';
                editStoreBtn.setAttribute('data-action', 'edit');
                editStoreBtn.setAttribute('data-store-id', store.storeId);
                editStoreBtn.className = 'inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500';
                editStoreBtn.title = 'Edit this store';
            }
        }

        function updateStoreProducts(products) {
            const productsContainer = document.getElementById('products-container');
            const noProductsMessage = document.getElementById('no-products-message');

            if (!products || products.length === 0) {
                noProductsMessage.style.display = 'block';
                return;
            }

            noProductsMessage.style.display = 'none';

            // Clear container
            productsContainer.innerHTML = '';

            // Add products
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'bg-white border border-gray-200 rounded-lg shadow overflow-hidden';

                const productImage = product.productImage || product.imageUrl || '/images/product-placeholder.svg';
                const productName = product.productName || product.name || 'Unnamed Product';
                const productPrice = formatCurrency(product.price || 0);
                const productStatus = product.isAvailable ? 'Available' : 'Unavailable';
                const statusClass = product.isAvailable ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800';

                productCard.innerHTML = `
                    <div class="h-40 bg-gray-200 overflow-hidden">
                        <img src="${productImage}" alt="${productName}" class="w-full h-full object-cover">
                    </div>
                    <div class="p-4">
                        <h3 class="text-sm font-medium text-gray-900 truncate">${productName}</h3>
                        <div class="mt-1 flex justify-between items-center">
                            <span class="text-sm font-bold text-gray-900">${productPrice}</span>
                            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${statusClass}">
                                ${productStatus}
                            </span>
                        </div>
                        <div class="mt-3">
                            <a href="/admin/products/${product.productId || product.id}" class="text-sm text-primary-600 hover:text-primary-500">
                                View Details
                            </a>
                        </div>
                    </div>
                `;

                productsContainer.appendChild(productCard);
            });
        }

        function updateSellerStatus(sellerId, newStatus) {
            const token = localStorage.getItem('token');

            fetch(`/api/admin/users/${sellerId}/update-status?status=${newStatus}`, {
                method: 'PUT',
                headers: {
                    'Authorization': token ? `Bearer ${token}` : '',
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to update seller status');
                }
                return response.json();
            })
            .then(data => {
                // Show success message
                alert(`Seller ${newStatus === 'BANNED' ? 'blocked' : 'unblocked'} successfully`);

                // Refresh the page to show updated status
                window.location.reload();
            })
            .catch(error => {
                console.error('Error:', error);
                alert(`Failed to update seller status: ${error.message}`);
            });
        }

        function showError(message) {
            const container = document.querySelector('main .max-w-7xl');
            container.innerHTML = `
                <div class="bg-white shadow sm:rounded-lg p-6 text-center">
                    <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">Error</h3>
                    <p class="text-gray-500">${message}</p>
                    <a href="/admin/dashboard" class="mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                        Return to Dashboard
                    </a>
                </div>
            `;
        }

        function formatDate(dateString) {
            if (!dateString) return '';

            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function formatCurrency(amount) {
            return '$' + parseFloat(amount).toFixed(2);
        }
    </script>
</body>
</html>
